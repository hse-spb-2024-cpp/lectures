# Тип лямбда-функции
Для каждой лямбды компилятор создаёт новый тип, который нельзя никак явно назвать, но можно вывести через `auto`.
Используйте https://cppinsights.io, чтобы посмотреть, во что на самом деле превращается лямбда-функция.

Обратите внимание, какие поля есть у лямбда-функции, когда и чем они инициализируются, и какие спецификаторы есть у `operator()`.

# Захваты
По умолчанию лямбда-функция не может обращаться к локальным переменным и нестатическим полям,
то есть ведёт себя почти как обычная глобальная функция.

При желании можно "зашить" внутрь лямбда функции ссылки или значения на локальные переменные,
это называется "захват" (capture).
Нужно явно перечислить, как именно захватывать переменные внутри `[]`.

Захваты бывают:

* `[&]` — захват всех используемых внутри лямбды локальных переменных по ссылке.
  Внутри лямбды сохраняется ссылка.
  Если лямбда живёт дольше захваченных переменных, получается висячая ссылка и UB при вызове.
* `[&a]` — захват конкретно переменной `a` по ссылке.
* `[=]` — захват всех используемых внутри лямбды локальных переменных по значению.
  Они все копируются внутрь лямбды, что может быть долго.
* `[a]` — захват конкретно переменной `a` по значению.
* `[a = b]` (С++14) — создание новой переменной `a` внутри лямбды, инициализация выражением `b`.
  Имя `a` может совпадат с именем локальной переменной.
* `[&a = b]` (С++14) — создание новой ссылки `a` внутри лямбды, привязанной к выражению `b`.
  Имя `a` может совпадат с именем локальной переменной.
* `[this]` — захват указателя `this` по значению.
  По сути текущий объект захватывается по ссылке.
* `[*this]` (C++17) — захват объекта `*this` по значению, создаётся его копия.
  Полная копия, даже если нужны только какие-то поля.

Также можно комбинировать несколько захватов, для каждой используемой переменной выберется наиболее специфичный: `[&, a, &b = c, *this]`.

Поля захватываются только вместе с `this`/`*this` (если только не написать через `x = x`).
Из `[=]` и `[&]` следует `[this]` (если он используется).

# Константность
По умолчанию `operator()` у лямбды помечен `const`: она не может менять свои поля (то есть захваченные значения).
Можно добавить слово `mutable`, тогда этот const qualifier уберётся.
Так делают довольно редко, обычно лямбды делают без состояния.
